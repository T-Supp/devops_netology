## Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."  

----

### Задача 1

Вкратце опишите, как вы поняли - в чем основное отличие паравиртуализации и виртуализации на основе ОС.  

### Ответ:  

При паравирутализации гостевая ОС используют только собственные ресурсы выделенные гипервизором.  
Контейнеры (виртуализация на основе ОС) могут использовать все ресурсы хостовой машины (доступно все железо), так же используют общие динамические библиотеки, общие страницы памяти на хостовой машине, что может экономить ресурсы. При этом контейнер и хостовая машина должны быть на одинаковом ядре (в базовом понимании).  

Другими словами: при паравиртуализации имеется слой гипервизора (отвечающий за разделение ресурсов) в хостовой машине, осуществляющих взаимодействия гостевой ос и железа. В контейнерной реализации, контейнер обращается без явного слоя гипервизора в ОС, разделение ресурсов осуществляется на уровне ОС.  

---

### Доработка:  

_Полная виртуализация_  
Такая виртуализация предполагает создание виртуального компьютера со своей операционной системой, который работает как настоящий. Полная виртуализация — почти полная симуляция "железа", гостевое ПО работает без изменения.  
Эта технология обеспечивает виртуализацию без изменения гостевой операционной системы.  

_Паравиртуализация_  
Идея состоит в том, что гостевые операционные системы специально подготавливаются для исполнения в виртуализированной среде, для чего их ядро незначительно модифицируется, гостевая ОС взаимодействует с гипервизором через специальный API.  
Паравиртуализация требует, чтобы ядро гостевой операционной системы было изменено для гипервизора.  

---

### Задача 2

Выберите тип один из вариантов использования организации физических серверов, в зависимости от условий использования.  

Организация серверов:
- физические сервера
- паравиртуализация
- виртуализация уровня ОС

Условия использования:

- Высоконагруженная база данных, чувствительная к отказу
- Различные Java-приложения
- Windows системы для использования Бухгалтерским отделом 
- Системы, выполняющие высокопроизводительные расчеты на GPU

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.  

### Ответ:  

#### Высоконагруженная база данных, чувствительная к отказу

_Физический сервер_  
        требуется более высокая производительность, аппаратное размещение дает более высокий отклик и сокращает точки отказа в виде гипервизора хостовой машины. Но возможно использование полной аппаратной виртуализации при использовании кластеризации для повышения доступности.  

#### Различные Java-приложения  

_Виртуализация уровня ОС (контейнеры)_  
        Требуется меньше ресурсов, выше скорость масштабирования при необходимости расширения. Нет жестких требований к аппаратным ресурсам, требует меньше ресурсов на администрирование.  

#### Windows системы для использования Бухгалтерским отделом  
_Паравиртуализация_  
        эффективнее делать бэкап, возможность расширения ресурсов на уровне виртуальной машины. Нет критичных требований к доступу к аппаратной составляющей сервера.  
        
#### Системы, выполняющие высокопроизводительные расчеты на GPU
_Физические сервера_   
        Для аппаратных расчетов требуется максимальный доступ к аппаратным ресурсам, следовательно, физический сервер делает это более эффективно.   

---  

### Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

* 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
* Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
* Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
* Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

### Ответ:  

В ТЗ нет информации о том, что имеется в инфраструктуре, компетенции персонала, предпочтения в организации.   
1. MS Hyper-V - так как он более совместим с инфраструктурой на MS, меньше затрат на обучение персонала.  
       Имеет широкий функционал. Если используется AD, соответственно совместимость Hyper-V будет в приоритете.  
       Но возможно использование и VMWare, все зависит от компетенций персонала.  
2. KVM - гостевые ос могут быть любыми, бесплатен и вполне производителен. Так же может подойти XEN, но он менее производителен.  
3. Hyper-V, с Windows будет максимально совместим. В бесплатном исполнении вполне работоспособен.
4. Для теста достаточно бесплатных KVM или XEN. 
      Если развертывание требуется на не длительном времени, то можно рассмотреть облачные системы AWS/Openstack, т.к. не требуют поддержания своей инфраструктуры.  

---  

### Задача 4  

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.  

### Ответ:  

Проблемы гетерогенной среды:  
+ содержать несколько команд администрирования/сопровождения для разных систем.  
+ ниже масштабируемость, придется масштабировать 2(или более) системы.  
+ сложности при выделении и управлении ресурсами.  
+ финансовые затраты, так как необходимо содержать несколько систем одновременно.    
+ проблемы миграции между разными системами.  
+ полное дублирование всей инфраструктуры под 2(или более) системы виртуализации. Если продуктив и тест в разных системах, то отлавливать "баги" сложнее.  

Опыта мало, но предположу:  
* распределить системы по совместимости, например, Hyper-V для всей Windows инфраструктуры и VMWare для остальных.    
* обучить команду сопровождения работе с обоими системами для взаимозаменяемости.  

Возможно выбрал бы одну систему, т.к. содержать такую проще и практичнее, но, скорее всего, будут нюансы в используемых задачах.  
Без комплексного видения очень сложно сказать. При использовании инфраструктуры на Windows, серверов на Windows, то логичнее использовать Hyper-V, чтобы не плодить зоопарка систем.  
